\documentclass{standalone}

\usepackage{tikz}
\usepackage{pgfplots}
\usepackage{verbatim}

\pgfplotsset{ every non boxed x axis/.append style={x axis line style=-},
     every non boxed y axis/.append style={y axis line style=-}}     
\pgfplotsset{compat = 1.3}

\begin{document}
\scriptsize

\begin{tikzpicture}[remember picture, baseline=0pt, scale = 0.8]
    \begin{axis}[
        ylabel shift = -2 pt,
        width=7cm,
        height=5cm,
        axis lines=left,
        ytick = {0, 200, 400, 600, 800, 1000},
        ymajorgrids=true,
        xmajorgrids=true,        
		scaled y ticks = true,
		scaled y ticks=base 10:-3,
        ymin = 0, ymax = 1100,
        major grid style={draw=lightgray},
        ylabel={\scriptsize $\mathrm{\bf Kernel~size}$},
        scaled x ticks = false,                   
        ]
    \addplot[smooth,line width=0.4mm] plot coordinates {
		(80000, 7)
		(210000, 471)
		(350000, 635)
		(470000, 741)
		(600000, 873)
		(750000, 957)
		(860000, 1000)
		(1020000, 1029)
		(1130000, 1044)
		(1250000, 1055)
		(1390000, 1062)
		(1500000, 1066)
		(1640000, 1064)
		(1750000, 1066)
		(1870000, 1065)
		(2000000, 1062)
		(2130000, 1057)
		(2260000, 1054)
		(2360000, 1049)
		(2480000, 1046)
		(2630000, 1042)
		(2740000, 1038)
		(2860000, 1036)
		(2990000, 1032)
		(3100000, 1030)
		(3260000, 1026)
		(3360000, 1023)
		(3508494, 1020)
		(3658494, 1017)
		(3718494, 1014)
    }; \label{kernelSizePlsa}
    
    \addplot[smooth,line width=0.2mm] plot coordinates {
		(80000, 7)
		(210000, 4)
		(340000, 20)
		(470000, 67)
		(600000, 162)
		(750000, 335)
		(860000, 433)
		(1020000, 480)
		(1130000, 539)
		(1250000, 615)
		(1390000, 679)
		(1500000, 717)
		(1640000, 745)
		(1760000, 775)
		(1870000, 790)
		(2010000, 824)
		(2140000, 837)
		(2250000, 859)
		(2350000, 867)
		(2480000, 880)
		(2620000, 894)
		(2730000, 895)
		(2850000, 903)
		(2990000, 920)
		(3100000, 927)
		(3260000, 936)
		(3360000, 937)
		(3518494, 945)
		(3658494, 954)
		(3718494, 952)    
    }; \label{kernelSizeLda}
    \end{axis}
    
    \begin{axis}[
    	ylabel shift = -4 pt,
        width=7cm,
        height=5cm,
        axis lines=left,
        axis x line*=top,
        xtick=\empty,
        axis y line*=right,
        ymin = 0, ymax = 1.1,
        ylabel near ticks,             
        ylabel={\scriptsize $\mathrm{\bf Purity~and~contrast}$},
        legend columns=3, 
        legend style={
            text width=4.5em,
            text height=1.5ex,
            text depth=.5ex,
        	draw=none,
            /tikz/column 3/.style={
                column sep=0pt,
            },
            at={(axis description cs:0.98,-0.14)}
        },        
        ]
    \addlegendimage{smooth, black}        
    \addlegendimage{dashed, black} 
    \addlegendimage{dotted, black}
    \addlegendimage{/pgfplots/refstyle=perplexityPlsa}\addlegendentry{\scriptsize $\mathrm{\hphantom{A}Size}$} 
    \addplot[dashed,line width=0.4mm] plot coordinates {
		(80000, 0.000000)
		(210000, 0.006000)
		(350000, 0.013000)
		(470000, 0.030000)
		(600000, 0.065000)
		(750000, 0.109000)
		(860000, 0.153000)
		(1020000, 0.199000)
		(1130000, 0.237000)
		(1250000, 0.266000)
		(1390000, 0.301000)
		(1500000, 0.331000)
		(1640000, 0.384000)
		(1750000, 0.402000)
		(1870000, 0.409000)
		(2000000, 0.427000)
		(2130000, 0.445000)
		(2260000, 0.455000)
		(2360000, 0.469000)
		(2480000, 0.481000)
		(2630000, 0.491000)
		(2740000, 0.503000)
		(2860000, 0.505000)
		(2990000, 0.513000)
		(3100000, 0.521000)
		(3260000, 0.527000)
		(3360000, 0.536000)
		(3508494, 0.542000)
		(3658494, 0.547000)
		(3718494, 0.553000)
    };           
    \addlegendentry{\scriptsize $\mathrm{\hphantom{A}Purity}$}

    \addplot[dashed,line width=0.2mm] plot coordinates {
		(80000, 0.000000)
		(210000, 0.001000)
		(340000, 0.002000)
		(470000, 0.010000)
		(600000, 0.023000)
		(750000, 0.051000)
		(860000, 0.073000)
		(1020000, 0.104000)
		(1130000, 0.125000)
		(1250000, 0.151000)
		(1390000, 0.177000)
		(1500000, 0.201000)
		(1640000, 0.220000)
		(1760000, 0.238000)
		(1870000, 0.250000)
		(2010000, 0.270000)
		(2140000, 0.287000)
		(2250000, 0.297000)
		(2350000, 0.309000)
		(2480000, 0.323000)
		(2620000, 0.335000)
		(2730000, 0.343000)
		(2850000, 0.354000)
		(2990000, 0.363000)
		(3100000, 0.369000)
		(3260000, 0.379000)
		(3360000, 0.384000)
		(3518494, 0.393000)
		(3658494, 0.400000)
		(3718494, 0.403000)
    };
    
    \addplot[dotted,line width=0.4mm] plot coordinates {
		(80000, 0.313000)
		(210000, 0.559000)
		(350000, 0.501000)
		(470000, 0.527000)
		(600000, 0.540000)
		(750000, 0.557000)
		(860000, 0.572000)
		(1020000, 0.585000)
		(1130000, 0.596000)
		(1250000, 0.605000)
		(1390000, 0.614000)
		(1500000, 0.622000)
		(1640000, 0.646000)
		(1750000, 0.651000)
		(1870000, 0.654000)
		(2000000, 0.660000)
		(2130000, 0.667000)
		(2260000, 0.671000)
		(2360000, 0.676000)
		(2480000, 0.680000)
		(2630000, 0.683000)
		(2740000, 0.687000)
		(2860000, 0.689000)
		(2990000, 0.691000)
		(3100000, 0.693000)
		(3260000, 0.696000)
		(3360000, 0.698000)
		(3508494, 0.700000)
		(3658494, 0.702000)
		(3718494, 0.704000)
    };         
    \addlegendentry{\scriptsize $\mathrm{\hphantom{A}Contrast}$}  
    
    \addplot[dotted,line width=0.2mm] plot coordinates {
		(80000, 0.308000)
		(210000, 0.303000)
		(340000, 0.328000)
		(470000, 0.337000)
		(600000, 0.350000)
		(750000, 0.373000)
		(860000, 0.386000)
		(1020000, 0.390000)
		(1130000, 0.400000)
		(1250000, 0.413000)
		(1390000, 0.427000)
		(1500000, 0.436000)
		(1640000, 0.443000)
		(1760000, 0.451000)
		(1870000, 0.456000)
		(2010000, 0.466000)
		(2140000, 0.471000)
		(2250000, 0.477000)
		(2350000, 0.480000)
		(2480000, 0.485000)
		(2620000, 0.489000)
		(2730000, 0.491000)
		(2850000, 0.494000)
		(2990000, 0.499000)
		(3100000, 0.502000)
		(3260000, 0.506000)
		(3360000, 0.507000)
		(3518494, 0.510000)
		(3658494, 0.513000)
		(3718494, 0.513000)	
    };
    \end{axis}
\end{tikzpicture}
\normalsize
\end{document}