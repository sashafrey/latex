\documentclass{article}
\usepackage{verbatim}
\usepackage{tikz}
\usetikzlibrary{patterns}

\pagenumbering{gobble}
\newcounter{wavenum}

\setlength{\unitlength}{1cm}
% advance clock one cycle, not to be called directly
\newcommand*{\clki}{
  \draw (t_cur) -- ++(0,.0) -- ++(.5,0) -- ++(0,-.0) -- ++(.5,0) -- ++(0,.0)
    node[time] (t_cur) {};
}

\newcommand*{\MergerQueue}[3]{
  \fill[fill=#3]
                         (t_cur) -- ++( .0, .04) -- ++(#2-.0,0) -- ++(.0, -.04)
                         -- ++(-.0,-.04) -- ++(.0-#2,0) -- cycle;
  \path (t_cur) -- node[anchor=mid] {#1} ++(#2,0) node[time] (t_cur) {};
}

\newcommand*{\MQFull}[2][XXX]{
    \MergerQueue{#1}{#2}{red}
}

\newcommand*{\MQNormal}[2]{
    \MergerQueue{#1}{#2}{green}
}

\newcommand*{\bitvector}[6]{
  \fill[fill=#3, pattern=#5, pattern color=#4,fill opacity=#6]
                         (t_cur) -- ++( .0, .2) -- ++(#2-.0,0) -- ++(.0, -.18)
                         -- ++(-.0,-.18) -- ++(.0-#2,0) -- cycle;
  \path (t_cur) -- node[anchor=mid] {#1} ++(#2,0) node[time] (t_cur) {};
}

% \known{val}{length}
\newcommand*{\Wait}[2]{
    \bitvector{#1}{#2}{white}{white}{}{0.0}
}

% \unknown{length}
\newcommand*{\ProcBatchOne}[2][XXX]{
    \bitvector{#1}{#2}{orange}{orange}{}{1.0}
}

% \unknown{length}
\newcommand*{\ProcBatchTwo}[2][XXX]{
    \bitvector{#1}{#2}{yellow}{yellow}{}{1.0}
}

% \unknown{length}
\newcommand*{\Regularization}[2][XXX]{
    \bitvector{#1}{#2}{red}{red}{}{1.0}
}

% \unknown{length}
\newcommand*{\Normalization}[2][XXX]{
    \bitvector{#1}{#2}{green}{green}{}{1.0}
}

% \unknown{length}
\newcommand*{\Merge}[2][XXX]{
    \bitvector{#1}{#2}{blue}{blue}{}{1.0}
}

% \nextwave{name}
\newcommand{\nextwave}[1]{
  \path (0,\value{wavenum} * 0.5) node[left] {#1} node[time] (t_cur) {};
  \addtocounter{wavenum}{-1}
}

% \begin{wave}[clkname]{num_waves}{clock_cycles}
\newenvironment{wave}[3][\bf{time}]{
  \begin{tikzpicture}[draw=black, yscale=1.5,xscale=1.0]
    \tikzstyle{time}=[coordinate]
    \setlength{\unitlength}{1cm}
    \def\wavewidth{#3}
    \setcounter{wavenum}{0}
    \nextwave{#1}

    \draw[dotted] (t_cur) +(0,.1) node[above] {t=0\%} -- ++(0,2.8-#2);
    \clki
    \foreach \t in {1,...,\wavewidth}{
      \draw[dotted] (t_cur) +(0,.1) node[above] {\t0\%} -- ++(0,2.8-#2);
      \clki
    }
}{\end{tikzpicture}}

%%% End of timing.sty
\usepackage{verbatim}

\begin{document}
\begin{wave}{5}{10}
\nextwave{10596} \Wait{ }{0.122939567821}\ProcBatchTwo[ ]{1.96726757211} \Wait{ }{0.122895601513} \ProcBatchTwo[ ]{1.88526552231} \Wait{ }{0.122939567821} \ProcBatchOne[ ]{1.80334651997} \Wait{ }{0.0819190023361} \ProcBatchOne[ ]{1.02457130407} \Wait{ }{0.122978648984} \ProcBatchTwo[ ]{1.721305389} 
\nextwave{17976} \Wait{ }{0.0409814843221}\ProcBatchTwo[ ]{1.02465435154} \Wait{ }{0.0819190023361} \ProcBatchTwo[ ]{1.27048952087} \Wait{ }{0.122934682676} \ProcBatchTwo[ ]{1.88526552231} \Wait{ }{0.082002049807} \ProcBatchOne[ ]{1.06554790325} \Wait{ }{0.0819629686442} \ProcBatchOne[ ]{1.55738433686} \Wait{ }{0.0409814843221} \ProcBatchTwo[ ]{0.532817917932} \Wait{ }{0.0819141171907} \ProcBatchTwo[ ]{0.655757485752} 
\nextwave{15212} \Wait{ }{0.082002049807}\ProcBatchTwo[ ]{1.84424495682} \Wait{ }{0.122939567821} \ProcBatchTwo[ ]{1.8032634725} \Wait{ }{0.123022615292} \ProcBatchOne[ ]{2.09011920732} \Wait{ }{0.082002049807} \ProcBatchOne[ ]{1.6393473055} \Wait{ }{0.286855734819} \ProcBatchTwo[ ]{1.92620304032} 
\nextwave{16956} \Wait{ }{0.0}\ProcBatchTwo[ ]{0.573799402254} \Wait{ }{0.0819580834989} \ProcBatchTwo[ ]{2.45902095825} \Wait{ }{0.122978648984} \ProcBatchTwo[ ]{1.84420099051} \Wait{ }{0.409839268948} \ProcBatchOne[ ]{2.04922565561} \Wait{ }{0.0819580834989} \ProcBatchTwo[ ]{1.02457130407} 
\end{wave}

\vspace{-0.4cm}
\begin{flushleft}
$\qquad$\bf{memory usage}
\end{flushleft}
\vspace{-.55cm}
$\qquad\qquad\quad\,$
\begin{tikzpicture}[x=1cm,y=0.4cm]

  \def\xmin{0}
  \def\xmax{12.0}
  \def\ymin{0}
  \def\ymax{14}

  % axes
  \foreach \y in {0,...,10}
	  \draw[dotted] (\xmin + \y,\ymin) -- (\xmin + \y,\ymax) node[above] {};

%%%%% START_MARKER_2 %%%%%
  \foreach \y in {2,4,...,12}
    \node at (\xmin,\y) [left] {\y};

  \draw[color=blue] plot[smooth,mark=*,mark size=1pt] file {data.dat}
   node [right] {};

\end{tikzpicture}

\end{document}